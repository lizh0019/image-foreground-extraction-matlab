<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><link rel="stylesheet" href="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for kmeans</title><link rel="stylesheet" href="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size: 14pt; padding: 0; background: #FFE4B0">kmeans (2 calls, 0.015 sec)</span><br/><i>Generated 31-Jul-2008 14:38:45 using real time.</i><br/>M-function in file C:\MATLABR14SP3\toolbox\stats\kmeans.m<br/>[Copy to new window for comparing multiple runs]<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file2.html">SegmentExcGC</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line290">290</a></td><td class="td-linebottomrt"><pre>if ~isfloat(C)      % X may be...</pre></td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.015 s</td><td class="td-linebottomrt" class="td-linebottomrt">99.8%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=100 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line336">336</a></td><td class="td-linebottomrt"><pre>previdx = idx;</pre></td><td class="td-linebottomrt">12</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line342">342</a></td><td class="td-linebottomrt"><pre>moved = 1:n;</pre></td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line299">299</a></td><td class="td-linebottomrt"><pre>changed = 1:k; % everything is...</pre></td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line508">508</a></td><td class="td-linebottomrt"><pre>previdx = idx;</pre></td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Other lines &amp; overhead</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.015 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file73.html">stats\private\statgetargs</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file40.html">cell.strmatch</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">6</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file74.html">strvcat</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file42.html">strmatch</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file43.html">repmat</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">8</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file75.html">randsample</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file77.html">kmeans>distfun</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">14</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file78.html">kmeans>gcentroids</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file36.html">unique</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">8</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.015 s</td><td class="td-linebottomrt">99.8%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=100 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.015 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line237">237</a></td><td class="td-linebottomrt"><span class="mono">Constructing a cell array is faster than using STRVCAT.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line295">295</a></td><td class="td-linebottomrt"><span class="mono">The value assigned here to variable 'dum' might never be used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line352">352</a></td><td class="td-linebottomrt"><span class="mono">ISEMPTY(x) is usually faster than LENGTH(x)==0</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line390">390</a></td><td class="td-linebottomrt"><span class="mono">The value assigned here to variable 'dlarge' might never be used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line476">476</a></td><td class="td-linebottomrt"><span class="mono">Array 'normC' might be grown using indexing. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line516">516</a></td><td class="td-linebottomrt"><span class="mono">ISEMPTY(x) is usually faster than LENGTH(x)==0</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line519">519</a></td><td class="td-linebottomrt"><span class="mono">Use || instead of | as the OR operator in (scalar) conditional statements.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line590">590</a></td><td class="td-linebottomrt"><span class="mono">Use && instead of & as the AND operator in (scalar) conditional statements.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in file</td><td class="td-linebottomrt">629</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">245</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">384</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">139</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">245</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">36.20 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">function [idx, C, sumD, D] = kmeans(X, k, varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%KMEANS K-means clustering.</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   IDX = KMEANS(X, K) partitions the points in the N-by-P data matrix</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   X into K clusters.  This partition minimizes the sum, over all</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   clusters, of the within-cluster sums of point-to-cluster-centroid</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   distances.  Rows of X correspond to points, columns correspond to</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   variables.  KMEANS returns an N-by-1 vector IDX containing the</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   cluster indices of each point.  By default, KMEANS uses squared</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Euclidean distances.</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   KMEANS treats NaNs as missing data, and removes any rows of X that</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   contain NaNs. </span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   [IDX, C] = KMEANS(X, K) returns the K cluster centroid locations in</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   the K-by-P matrix C.</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   [IDX, C, SUMD] = KMEANS(X, K) returns the within-cluster sums of</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   point-to-centroid distances in the 1-by-K vector sumD.</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   [IDX, C, SUMD, D] = KMEANS(X, K) returns distances from each point</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   to every centroid in the N-by-K matrix D.</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   [ ... ] = KMEANS(..., 'PARAM1',val1, 'PARAM2',val2, ...) allows you to</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   specify optional parameter name/value pairs to control the iterative</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   algorithm used by KMEANS.  Parameters are:</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   'Distance' - Distance measure, in P-dimensional space, that KMEANS</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      should minimize with respect to.  Choices are:</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%            {'sqEuclidean'} - Squared Euclidean distance</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%             'cityblock'    - Sum of absolute differences, a.k.a. L1</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%             'cosine'       - One minus the cosine of the included angle</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              between points (treated as vectors)</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%             'correlation'  - One minus the sample correlation between</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              points (treated as sequences of values)</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%             'Hamming'      - Percentage of bits that differ (only</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              suitable for binary data)</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   'Start' - Method used to choose initial cluster centroid positions,</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      sometimes known as "seeds".  Choices are:</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                 {'sample'} - Select K observations from X at random</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                  'uniform' - Select K points uniformly at random from</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              the range of X.  Not valid for Hamming distance.</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                  'cluster' - Perform preliminary clustering phase on</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              random 10% subsample of X.  This preliminary</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              phase is itself initialized using 'sample'.</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                  matrix    - A K-by-P matrix of starting locations.  In</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              this case, you can pass in [] for K, and</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              KMEANS infers K from the first dimension of</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              the matrix.  You can also supply a 3D array,</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              implying a value for 'Replicates'</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              from the array's third dimension.</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   'Replicates' - Number of times to repeat the clustering, each with a</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      new set of initial centroids [ positive integer | {1}]</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   'Maxiter' - The maximum number of iterations [ positive integer | {100}]</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   'EmptyAction' - Action to take if a cluster loses all of its member</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      observations.  Choices are:</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%               {'error'}    - Treat an empty cluster as an error</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                'drop'      - Remove any clusters that become empty, and</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              set corresponding values in C and D to NaN.</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                'singleton' - Create a new cluster consisting of the one</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                              observation furthest from its centroid.</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   'Display' - Display level [ 'off' | {'notify'} | 'final' | 'iter' ]</span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Example:</span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       X = [randn(20,2)+ones(20,2); randn(20,2)-ones(20,2)];</span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       [cidx, ctrs] = kmeans(X, 2, 'dist','city', 'rep',5, 'disp','final');</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       plot(X(cidx==1,1),X(cidx==1,2),'r.', ...</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%            X(cidx==2,1),X(cidx==2,2),'b.', ctrs(:,1),ctrs(:,2),'kx');</span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   See also LINKAGE, CLUSTERDATA, SILHOUETTE.</span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   KMEANS uses a two-phase iterative algorithm to minimize the sum of</span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   point-to-centroid distances, summed over all K clusters.  The first</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   phase uses what the literature often describes as "batch" updates,</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   where each iteration consists of reassigning points to their nearest</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   cluster centroid, all at once, followed by recalculation of cluster</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   centroids. This phase may be thought of as providing a fast but</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   potentially only approximate solution as a starting point for the</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   second phase.  The second phase uses what the literature often</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   describes as "on-line" updates, where points are individually</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   reassigned if doing so will reduce the sum of distances, and cluster</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   centroids are recomputed after each reassignment.  Each iteration</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   during this second phase consists of one pass though all the points.</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   KMEANS can converge to a local optimum, which in this case is a</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   partition of points in which moving any single point to a different</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   cluster increases the total sum of distances.  This problem can only be</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   solved by a clever (or lucky, or exhaustive) choice of starting points.</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% References:</span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   [1] Seber, G.A.F., Multivariate Observations, Wiley, New York, 1984.</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   [2] Spath, H. (1985) Cluster Dissection and Analysis: Theory, FORTRAN</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       Programs, Examples, translated by J. Goldschmidt, Halsted Press,</span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       New York, 226 pp.</span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Copyright 1993-2004 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   $Revision: 1.4.4.5 $  $Date: 2004/03/02 21:49:12 $</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 104</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if nargin &lt; 2 </span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:TooFewInputs','At least two input arguments required.');</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 108</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if any(isnan(X(:))) </span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    warning('stats:kmeans:MissingDataRemoved','Removing rows of X with missing data.');</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    X = X(~any(isnan(X),2),:);</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% n points in p dimensional space</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 114</span> <span style="color: #000000; background: #FFFFFF; padding: 1">[n, p] = size(X); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 115</span> <span style="color: #000000; background: #FFFFFF; padding: 1">Xsort = []; Xord = []; </span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF; padding: 1">pnames = {   'distance'  'start' 'replicates' 'maxiter' 'emptyaction' 'display'}; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF; padding: 1">dflts =  {'sqeuclidean' 'sample'          []       100        'error'  'notify'}; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF; padding: 1">[eid,errmsg,distance,start,reps,maxit,emptyact,display] ... </span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                       = statgetargs(pnames, dflts, varargin{:});</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 121</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if ~isempty(eid) </span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error(sprintf('stats:kmeans:%s',eid),errmsg);</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 125</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if ischar(distance) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    distNames = {'sqeuclidean','cityblock','cosine','correlation','hamming'}; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 127</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    i = <a href="file42.html">strmatch</a>(lower(distance), distNames); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 128</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if length(i) &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:AmbiguousDistance', ...</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Ambiguous ''distance'' parameter value:  %s.', distance);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 131</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    elseif isempty(i) </span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:UnknownDistance', ...</span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Unknown ''distance'' parameter value:  %s.', distance);</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 135</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    distance = distNames{i}; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    switch distance  </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'cityblock' </span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        [Xsort,Xord] = sort(X,1);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 139</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'cosine' </span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xnorm = sqrt(sum(X.^2, 2));</span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if any(min(Xnorm) &lt;= eps(max(Xnorm)))</span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            error('stats:kmeans:ZeroDataForCos', ...</span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                  ['Some points have small relative magnitudes, making them ', ...</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                   'effectively zero.\nEither remove those points, or choose a ', ...</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                   'distance other than ''cosine''.']);</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        X = X ./ Xnorm(:,ones(1,p));</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 148</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'correlation' </span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        X = X - repmat(mean(X,2),1,p);</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xnorm = sqrt(sum(X.^2, 2));</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if any(min(Xnorm) &lt;= eps(max(Xnorm)))</span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            error('stats:kmeans:ConstantDataForCorr', ...</span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                  ['Some points have small relative standard deviations, making them ', ...</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                   'effectively constant.\nEither remove those points, or choose a ', ...</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                   'distance other than ''correlation''.']);</span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        X = X ./ Xnorm(:,ones(1,p));</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 158</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'hamming' </span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if ~all(ismember(X(:),[0 1]))</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            error('stats:kmeans:NonbinaryDataForHamm', ...</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                  'Non-binary data cannot be clustered using Hamming distance.');</span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">else</span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:InvalidDistance', ...</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">          'The ''distance'' parameter value must be a string.');</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 169</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if ischar(start) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 170</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    startNames = {'uniform','sample','cluster'}; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    i = <a href="file42.html">strmatch</a>(lower(start), startNames); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 172</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if length(i) &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:AmbiguousStart', ...</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Ambiguous ''start'' parameter value:  %s.', start);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 175</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    elseif isempty(i) </span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:UnknownStart', ...</span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Unknown ''start'' parameter value:  %s.', start);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 178</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    elseif isempty(k) </span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:MissingK', ...</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'You must specify the number of clusters, K.');</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 182</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    start = startNames{i}; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 183</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if strcmp(start, 'uniform') </span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if strcmp(distance, 'hamming')</span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            error('stats:kmeans:UniformStartForHamm', ...</span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                  'Hamming distance cannot be initialized with uniform random values.');</span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xmins = min(X,1);</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xmaxs = max(X,1);</span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">elseif isnumeric(start)</span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    CC = start;</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    start = 'numeric';</span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if isempty(k)</span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        k = size(CC,1);</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    elseif k ~= size(CC,1);</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:MisshapedStart', ...</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'The ''start'' matrix must have K rows.');</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    elseif size(CC,2) ~= p</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:MisshapedStart', ...</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'The ''start'' matrix must have the same number of columns as X.');</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if isempty(reps)</span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        reps = size(CC,3);</span><br/>               <span style="color: #A0A0A0"> 205</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    elseif reps ~= size(CC,3);</span><br/>               <span style="color: #A0A0A0"> 206</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:MisshapedStart', ...</span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'The third dimension of the ''start'' array must match the ''replicates'' parameter value.');</span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    </span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % Need to center explicit starting points for 'correlation'. (Re)normalization</span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % for 'cosine'/'correlation' is done at each iteration.</span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if isequal(distance, 'correlation')</span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        CC = CC - repmat(mean(CC,2),[1,p,1]);</span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">else</span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:InvalidStart', ...</span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">          'The ''start'' parameter value must be a string or a numeric matrix or array.');</span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if ischar(emptyact) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    emptyactNames = {'error','drop','singleton'}; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 222</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    i = <a href="file42.html">strmatch</a>(lower(emptyact), emptyactNames); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if length(i) &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 224</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:AmbiguousEmptyAction', ...</span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Ambiguous ''emptyaction'' parameter value:  %s.', emptyact);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 226</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    elseif isempty(i) </span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:UnknownEmptyAction', ...</span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Unknown ''emptyaction'' parameter value:  %s.', emptyact);</span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    emptyact = emptyactNames{i}; </span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">else</span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:InvalidEmptyAction', ...</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">          'The ''emptyaction'' parameter value must be a string.');</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if ischar(display) </span><br/><a name="Line237"></a>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    i = <a href="file42.html">strmatch</a>(lower(display), <a href="file74.html">strvcat</a>('off','notify','final','iter')); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 238</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if length(i) &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:AmbiguousDisplay', ...</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Ambiguous ''display'' parameter value:  %s.', display);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 241</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    elseif isempty(i) </span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        error('stats:kmeans:UnknownDisplay', ...</span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">              'Unknown ''display'' parameter value:  %s.', display);</span><br/>               <span style="color: #A0A0A0"> 244</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    display = i-1; </span><br/>               <span style="color: #A0A0A0"> 246</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">else</span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:InvalidDisplay', ...</span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">          'The ''display'' parameter value must be a string.');</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 251</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if k == 1 </span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:OneCluster', ...</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">          'The number of clusters must be greater than 1.');</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 254</span> <span style="color: #000000; background: #FFFFFF; padding: 1">elseif n &lt; k </span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    error('stats:kmeans:TooManyClusters', ...</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">          'X must have more rows than the number of clusters.');</span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Assume one replicate</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if isempty(reps) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    reps = 1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 262</span> <span style="color: #000000; background: #FFFFFF; padding: 1">end </span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Done with input argument processing, begin clustering</span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF; padding: 1">dispfmt = '%6d\t%6d\t%8d\t%12g'; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF; padding: 1">D = <a href="file43.html">repmat</a>(NaN,n,k);   % point-to-cluster distances </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 270</span> <span style="color: #000000; background: #FFFFFF; padding: 1">Del = <a href="file43.html">repmat</a>(NaN,n,k); % reassignment criterion </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 271</span> <span style="color: #000000; background: #FFFFFF; padding: 1">m = zeros(k,1); </span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 273</span> <span style="color: #000000; background: #FFFFFF; padding: 1">totsumDBest = Inf; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 274</span> <span style="color: #000000; background: #FFFFFF; padding: 1">for rep = 1:reps </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    switch start </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 276</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'uniform' </span><br/>               <span style="color: #A0A0A0"> 277</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        C = unifrnd(Xmins(ones(k,1),:), Xmaxs(ones(k,1),:));</span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % For 'cosine' and 'correlation', these are uniform inside a subset</span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % of the unit hypersphere.  Still need to center them for</span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % 'correlation'.  (Re)normalization for 'cosine'/'correlation' is</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % done at each iteration.</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if isequal(distance, 'correlation')</span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C = C - repmat(mean(C,2),1,p);</span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if isa(X,'single')</span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C = single(C);</span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 288</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'sample' </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 289</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        C = X(<a href="file75.html">randsample</a>(n,k),:); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 290</span> <a name="Line290"></a><span style="color: #000000; background: #FF8080; padding: 1">        if ~isfloat(C)      % X may be logical </span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C = double(C);</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    case 'cluster'</span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xsubset = X(randsample(n,floor(.1*n)),:);</span><br/><a name="Line295"></a>               <span style="color: #A0A0A0"> 295</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        [dum, C] = kmeans(Xsubset, k, varargin{:}, 'start','sample', 'replicates',1);</span><br/>               <span style="color: #A0A0A0"> 296</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    case 'numeric'</span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        C = CC(:,:,rep);</span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end    </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 299</span> <a name="Line299"></a><span style="color: #000000; background: #FFFFFF; padding: 1">    changed = 1:k; % everything is newly assigned </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    idx = zeros(n,1); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 301</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    totsumD = Inf; </span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 303</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if display &gt; 2 % 'iter' </span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        disp(sprintf('  iter\t phase\t     num\t         sum'));</span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 306</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    </span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    %</span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % Begin phase one:  batch reassignments</span><br/>               <span style="color: #A0A0A0"> 309</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    %</span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    converged = false; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 312</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    iter = 0; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 313</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    while true </span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Compute the distance from every point to each cluster centroid</span><br/>       <span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 315</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        D(:,changed) = <a href="file77.html">distfun</a>(X, C(changed,:), distance, iter); </span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        </span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Compute the total sum of distances for the current configuration.</span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Can't do it first time through, there's no configuration yet.</span><br/>       <span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 319</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        if iter &gt; 0 </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 320</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            totsumD = sum(D((idx-1)*n + (1:n)')); </span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Test for a cycle: if objective is not decreased, back out</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % the last step and move on to the single update phase</span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 323</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            if prevtotsumD &lt;= totsumD </span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                idx = previdx;</span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                [C(changed,:), m(changed)] = gcentroids(X, idx, changed, distance, Xsort, Xord);</span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                iter = iter - 1;</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                break;</span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 329</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            if display &gt; 2 % 'iter' </span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                disp(sprintf(dispfmt,iter,1,length(moved),totsumD));</span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 332</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            if iter &gt;= maxit, break; end </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 333</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        end </span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Determine closest cluster for each point and reassign points to clusters</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 336</span> <a name="Line336"></a><span style="color: #000000; background: #FFFFFF; padding: 1">        previdx = idx; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 337</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        prevtotsumD = totsumD; </span><br/>       <span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 338</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        [d, nidx] = min(D, [], 2); </span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 340</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        if iter == 0 </span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Every point moved, every cluster will need an update</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 342</span> <a name="Line342"></a><span style="color: #000000; background: #FFFFFF; padding: 1">            moved = 1:n; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 343</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            idx = nidx; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 344</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            changed = 1:k; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 345</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        else </span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Determine which points moved</span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 347</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            moved = find(nidx ~= previdx); </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 348</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            if length(moved) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % Resolve ties in favor of not moving</span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 350</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                moved = moved(D((previdx(moved)-1)*n + moved) &gt; d(moved)); </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 351</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            end </span><br/><a name="Line352"></a>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 352</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            if length(moved) == 0 </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 353</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                break; </span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 355</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            idx(moved) = nidx(moved); </span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Find clusters that gained or lost members</span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 358</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            changed = <a href="file36.html">unique</a>([idx(moved); previdx(moved)])'; </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 359</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        end </span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Calculate the new cluster centroids and counts.</span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 362</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        [C(changed,:), m(changed)] = <a href="file78.html">gcentroids</a>(X, idx, changed, distance, Xsort, Xord); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 363</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        iter = iter + 1; </span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        </span><br/>               <span style="color: #A0A0A0"> 365</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Deal with clusters that have just lost all their members</span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 366</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        empties = changed(m(changed) == 0); </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 367</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        if ~isempty(empties) </span><br/>               <span style="color: #A0A0A0"> 368</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            switch emptyact</span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            case 'error'</span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                error('stats:kmeans:EmptyCluster', ...</span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                      'Empty cluster created at iteration %d.',iter);</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            case 'drop'</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % Remove the empty cluster from any further processing</span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                D(:,empties) = NaN;</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                changed = changed(m(changed) &gt; 0);</span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                if display &gt; 0</span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    warning('stats:kmeans:EmptyCluster', ...</span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                            'Empty cluster created at iteration %d.',iter);</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            case 'singleton'</span><br/>               <span style="color: #A0A0A0"> 381</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                if display &gt; 0</span><br/>               <span style="color: #A0A0A0"> 382</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    warning('stats:kmeans:EmptyCluster', ...</span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                            'Empty cluster created at iteration %d.',iter);</span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                </span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                for i = empties</span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % Find the point furthest away from its current cluster.</span><br/>               <span style="color: #A0A0A0"> 388</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % Take that point out of its cluster and use it to create</span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % a new singleton cluster to replace the empty one.</span><br/><a name="Line390"></a>               <span style="color: #A0A0A0"> 390</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    [dlarge, lonely] = max(d);</span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    from = idx(lonely); % taking from this cluster</span><br/>               <span style="color: #A0A0A0"> 392</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    C(i,:) = X(lonely,:);</span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    m(i) = 1;</span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    idx(lonely) = i;</span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    d(lonely) = 0;</span><br/>               <span style="color: #A0A0A0"> 396</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    </span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % Update clusters from which points are taken</span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    [C(from,:), m(from)] = gcentroids(X, idx, from, distance, Xsort, Xord);</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    changed = unique([changed from]);</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 402</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 403</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    end % phase one </span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % Initialize some cluster information prior to phase two</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 406</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    switch distance </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 407</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'cityblock' </span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xmid = zeros([k,p,2]);</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        for i = 1:k</span><br/>               <span style="color: #A0A0A0"> 410</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            if m(i) &gt; 0</span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % Separate out sorted coords for points in i'th cluster,</span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % and save values above and below median, component-wise</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                Xsorted = reshape(Xsort(idx(Xord)==i), m(i), p);</span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                nn = floor(.5*m(i));</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                if mod(m(i),2) == 0</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Xmid(i,:,1:2) = Xsorted([nn, nn+1],:)';</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                elseif m(i) &gt; 1</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Xmid(i,:,1:2) = Xsorted([nn, nn+2],:)';</span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                else</span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Xmid(i,:,1:2) = Xsorted([1, 1],:)';</span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 424</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    case 'hamming' </span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        Xsum = zeros(k,p);</span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        for i = 1:k</span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            if m(i) &gt; 0</span><br/>               <span style="color: #A0A0A0"> 428</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % Sum coords for points in i'th cluster, component-wise</span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                Xsum(i,:) = sum(X(idx==i,:), 1);</span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    </span><br/>               <span style="color: #A0A0A0"> 434</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    %</span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % Begin phase two:  single reassignments</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    %</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 437</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    changed = find(m' &gt; 0); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 438</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    lastmoved = 0; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 439</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    nummoved = 0; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 440</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    iter1 = iter; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 441</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    while iter &lt; maxit </span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Calculate distances to each cluster from each point, and the</span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % potential change in total sum of errors for adding or removing</span><br/>               <span style="color: #A0A0A0"> 444</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % each point from each cluster.  Clusters that have not changed</span><br/>               <span style="color: #A0A0A0"> 445</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % membership need not be updated.</span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        %</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Singleton clusters are a special case for the sum of dists</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % calculation.  Removing their only point is never best, so the</span><br/>               <span style="color: #A0A0A0"> 449</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % reassignment criterion had better guarantee that a singleton</span><br/>               <span style="color: #A0A0A0"> 450</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % point will stay in its own cluster.  Happily, we get</span><br/>               <span style="color: #A0A0A0"> 451</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Del(i,idx(i)) == 0 automatically for them.</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 452</span> <span style="color: #000000; background: #FFFFFF; padding: 1">		switch distance </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 453</span> <span style="color: #000000; background: #FFFFFF; padding: 1">		case 'sqeuclidean' </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 454</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            for i = changed </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 455</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                mbrs = (idx == i); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 456</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                sgn = 1 - 2*mbrs; % -1 for members, 1 for nonmembers </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 457</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                if m(i) == 1 </span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    sgn(mbrs) = 0; % prevent divide-by-zero for singleton mbrs</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 460</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                Del(:,i) = (m(i) ./ (m(i) + sgn)) .* sum((X - C(<a href="file43.html">repmat</a>(i,n,1),:)).^2, 2); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 461</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            end </span><br/>               <span style="color: #A0A0A0"> 462</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case 'cityblock'</span><br/>               <span style="color: #A0A0A0"> 463</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            for i = changed</span><br/>               <span style="color: #A0A0A0"> 464</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                if mod(m(i),2) == 0 % this will never catch singleton clusters</span><br/>               <span style="color: #A0A0A0"> 465</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    ldist = Xmid(repmat(i,n,1),:,1) - X;</span><br/>               <span style="color: #A0A0A0"> 466</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    rdist = X - Xmid(repmat(i,n,1),:,2);</span><br/>               <span style="color: #A0A0A0"> 467</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    mbrs = (idx == i);</span><br/>               <span style="color: #A0A0A0"> 468</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    sgn = repmat(1-2*mbrs, 1, p); % -1 for members, 1 for nonmembers</span><br/>               <span style="color: #A0A0A0"> 469</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Del(:,i) = sum(max(0, max(sgn.*rdist, sgn.*ldist)), 2);</span><br/>               <span style="color: #A0A0A0"> 470</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                else</span><br/>               <span style="color: #A0A0A0"> 471</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Del(:,i) = sum(abs(X - C(repmat(i,n,1),:)), 2);</span><br/>               <span style="color: #A0A0A0"> 472</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 473</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 474</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case {'cosine','correlation'}</span><br/>               <span style="color: #A0A0A0"> 475</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % The points are normalized, centroids are not, so normalize them</span><br/><a name="Line476"></a>               <span style="color: #A0A0A0"> 476</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            normC(changed) = sqrt(sum(C(changed,:).^2, 2));</span><br/>               <span style="color: #A0A0A0"> 477</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            if any(normC &lt; eps(class(normC))) % small relative to unit-length data points</span><br/>               <span style="color: #A0A0A0"> 478</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                error('stats:kmeans:ZeroCentroid', ...</span><br/>               <span style="color: #A0A0A0"> 479</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                      'Zero cluster centroid created at iteration %d.',iter);</span><br/>               <span style="color: #A0A0A0"> 480</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 481</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % This can be done without a loop, but the loop saves memory allocations</span><br/>               <span style="color: #A0A0A0"> 482</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            for i = changed</span><br/>               <span style="color: #A0A0A0"> 483</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                XCi = X * C(i,:)';</span><br/>               <span style="color: #A0A0A0"> 484</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                mbrs = (idx == i);</span><br/>               <span style="color: #A0A0A0"> 485</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                sgn = 1 - 2*mbrs; % -1 for members, 1 for nonmembers</span><br/>               <span style="color: #A0A0A0"> 486</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                Del(:,i) = 1 + sgn .*...</span><br/>               <span style="color: #A0A0A0"> 487</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                      (m(i).*normC(i) - sqrt((m(i).*normC(i)).^2 + 2.*sgn.*m(i).*XCi + 1));</span><br/>               <span style="color: #A0A0A0"> 488</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 489</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case 'hamming'</span><br/>               <span style="color: #A0A0A0"> 490</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            for i = changed</span><br/>               <span style="color: #A0A0A0"> 491</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                if mod(m(i),2) == 0 % this will never catch singleton clusters</span><br/>               <span style="color: #A0A0A0"> 492</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % coords with an unequal number of 0s and 1s have a</span><br/>               <span style="color: #A0A0A0"> 493</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % different contribution than coords with an equal</span><br/>               <span style="color: #A0A0A0"> 494</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                    % number</span><br/>               <span style="color: #A0A0A0"> 495</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    unequal01 = find(2*Xsum(i,:) ~= m(i));</span><br/>               <span style="color: #A0A0A0"> 496</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    numequal01 = p - length(unequal01);</span><br/>               <span style="color: #A0A0A0"> 497</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    mbrs = (idx == i);</span><br/>               <span style="color: #A0A0A0"> 498</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Di = abs(X(:,unequal01) - C(repmat(i,n,1),unequal01));</span><br/>               <span style="color: #A0A0A0"> 499</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Del(:,i) = (sum(Di, 2) + mbrs*numequal01) / p;</span><br/>               <span style="color: #A0A0A0"> 500</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                else</span><br/>               <span style="color: #A0A0A0"> 501</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Del(:,i) = sum(abs(X - C(repmat(i,n,1),:)), 2) / p;</span><br/>               <span style="color: #A0A0A0"> 502</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 503</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 504</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">		end</span><br/>               <span style="color: #A0A0A0"> 505</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 506</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Determine best possible move, if any, for each point.  Next we</span><br/>               <span style="color: #A0A0A0"> 507</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % will pick one from those that actually did move.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 508</span> <a name="Line508"></a><span style="color: #000000; background: #FFFFFF; padding: 1">        previdx = idx; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 509</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        prevtotsumD = totsumD; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 510</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        [minDel, nidx] = min(Del, [], 2); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 511</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        moved = find(previdx ~= nidx); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 512</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        if length(moved) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 513</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Resolve ties in favor of not moving</span><br/>               <span style="color: #A0A0A0"> 514</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            moved = moved(Del((previdx(moved)-1)*n + moved) &gt; minDel(moved));</span><br/>               <span style="color: #A0A0A0"> 515</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/><a name="Line516"></a>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 516</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        if length(moved) == 0 </span><br/>               <span style="color: #A0A0A0"> 517</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Count an iteration if phase 2 did nothing at all, or if we're</span><br/>               <span style="color: #A0A0A0"> 518</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % in the middle of a pass through all the points</span><br/><a name="Line519"></a>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 519</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            if (iter - iter1) == 0 | nummoved &gt; 0 </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 520</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                iter = iter + 1; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 521</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                if display &gt; 2 % 'iter' </span><br/>               <span style="color: #A0A0A0"> 522</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    disp(sprintf(dispfmt,iter,2,nummoved,totsumD));</span><br/>               <span style="color: #A0A0A0"> 523</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 524</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 525</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            converged = true; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 526</span> <span style="color: #000000; background: #FFFFFF; padding: 1">            break; </span><br/>               <span style="color: #A0A0A0"> 527</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 528</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        </span><br/>               <span style="color: #A0A0A0"> 529</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Pick the next move in cyclic order</span><br/>               <span style="color: #A0A0A0"> 530</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        moved = mod(min(mod(moved - lastmoved - 1, n) + lastmoved), n) + 1;</span><br/>               <span style="color: #A0A0A0"> 531</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        </span><br/>               <span style="color: #A0A0A0"> 532</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % If we've gone once through all the points, that's an iteration</span><br/>               <span style="color: #A0A0A0"> 533</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        if moved &lt;= lastmoved</span><br/>               <span style="color: #A0A0A0"> 534</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            iter = iter + 1;</span><br/>               <span style="color: #A0A0A0"> 535</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            if display &gt; 2 % 'iter'</span><br/>               <span style="color: #A0A0A0"> 536</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                disp(sprintf(dispfmt,iter,2,nummoved,totsumD));</span><br/>               <span style="color: #A0A0A0"> 537</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 538</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            if iter &gt;= maxit, break; end</span><br/>               <span style="color: #A0A0A0"> 539</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            nummoved = 0;</span><br/>               <span style="color: #A0A0A0"> 540</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 541</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        nummoved = nummoved + 1;</span><br/>               <span style="color: #A0A0A0"> 542</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        lastmoved = moved;</span><br/>               <span style="color: #A0A0A0"> 543</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        </span><br/>               <span style="color: #A0A0A0"> 544</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        oidx = idx(moved);</span><br/>               <span style="color: #A0A0A0"> 545</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        nidx = nidx(moved);</span><br/>               <span style="color: #A0A0A0"> 546</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        totsumD = totsumD + Del(moved,nidx) - Del(moved,oidx);</span><br/>               <span style="color: #A0A0A0"> 547</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        </span><br/>               <span style="color: #A0A0A0"> 548</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % Update the cluster index vector, and rhe old and new cluster</span><br/>               <span style="color: #A0A0A0"> 549</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">        % counts and centroids</span><br/>               <span style="color: #A0A0A0"> 550</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        idx(moved) = nidx;</span><br/>               <span style="color: #A0A0A0"> 551</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        m(nidx) = m(nidx) + 1;</span><br/>               <span style="color: #A0A0A0"> 552</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        m(oidx) = m(oidx) - 1;</span><br/>               <span style="color: #A0A0A0"> 553</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        switch distance</span><br/>               <span style="color: #A0A0A0"> 554</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case 'sqeuclidean'</span><br/>               <span style="color: #A0A0A0"> 555</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C(nidx,:) = C(nidx,:) + (X(moved,:) - C(nidx,:)) / m(nidx);</span><br/>               <span style="color: #A0A0A0"> 556</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C(oidx,:) = C(oidx,:) - (X(moved,:) - C(oidx,:)) / m(oidx);</span><br/>               <span style="color: #A0A0A0"> 557</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case 'cityblock'</span><br/>               <span style="color: #A0A0A0"> 558</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            for i = [oidx nidx]</span><br/>               <span style="color: #A0A0A0"> 559</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % Separate out sorted coords for points in each cluster.</span><br/>               <span style="color: #A0A0A0"> 560</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % New centroid is the coord median, save values above and</span><br/>               <span style="color: #A0A0A0"> 561</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">                % below median.  All done component-wise.</span><br/>               <span style="color: #A0A0A0"> 562</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                Xsorted = reshape(Xsort(idx(Xord)==i), m(i), p);</span><br/>               <span style="color: #A0A0A0"> 563</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                nn = floor(.5*m(i));</span><br/>               <span style="color: #A0A0A0"> 564</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                if mod(m(i),2) == 0</span><br/>               <span style="color: #A0A0A0"> 565</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    C(i,:) = .5 * (Xsorted(nn,:) + Xsorted(nn+1,:));</span><br/>               <span style="color: #A0A0A0"> 566</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    Xmid(i,:,1:2) = Xsorted([nn, nn+1],:)';</span><br/>               <span style="color: #A0A0A0"> 567</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                else</span><br/>               <span style="color: #A0A0A0"> 568</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    C(i,:) = Xsorted(nn+1,:);</span><br/>               <span style="color: #A0A0A0"> 569</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    if m(i) &gt; 1</span><br/>               <span style="color: #A0A0A0"> 570</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                        Xmid(i,:,1:2) = Xsorted([nn, nn+2],:)';</span><br/>               <span style="color: #A0A0A0"> 571</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    else</span><br/>               <span style="color: #A0A0A0"> 572</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                        Xmid(i,:,1:2) = Xsorted([1, 1],:)';</span><br/>               <span style="color: #A0A0A0"> 573</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                    end</span><br/>               <span style="color: #A0A0A0"> 574</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                end</span><br/>               <span style="color: #A0A0A0"> 575</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            end</span><br/>               <span style="color: #A0A0A0"> 576</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case {'cosine','correlation'}</span><br/>               <span style="color: #A0A0A0"> 577</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C(nidx,:) = C(nidx,:) + (X(moved,:) - C(nidx,:)) / m(nidx);</span><br/>               <span style="color: #A0A0A0"> 578</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C(oidx,:) = C(oidx,:) - (X(moved,:) - C(oidx,:)) / m(oidx);</span><br/>               <span style="color: #A0A0A0"> 579</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        case 'hamming'</span><br/>               <span style="color: #A0A0A0"> 580</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % Update summed coords for points in each cluster.  New</span><br/>               <span style="color: #A0A0A0"> 581</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">            % centroid is the coord median.  All done component-wise.</span><br/>               <span style="color: #A0A0A0"> 582</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            Xsum(nidx,:) = Xsum(nidx,:) + X(moved,:);</span><br/>               <span style="color: #A0A0A0"> 583</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            Xsum(oidx,:) = Xsum(oidx,:) - X(moved,:);</span><br/>               <span style="color: #A0A0A0"> 584</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C(nidx,:) = .5*sign(2*Xsum(nidx,:) - m(nidx)) + .5;</span><br/>               <span style="color: #A0A0A0"> 585</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            C(oidx,:) = .5*sign(2*Xsum(oidx,:) - m(oidx)) + .5;</span><br/>               <span style="color: #A0A0A0"> 586</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/>               <span style="color: #A0A0A0"> 587</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        changed = sort([oidx nidx]);</span><br/>               <span style="color: #A0A0A0"> 588</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end % phase two</span><br/>               <span style="color: #A0A0A0"> 589</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    </span><br/><a name="Line590"></a>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 590</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if (~converged) &amp; (display &gt; 0) </span><br/>               <span style="color: #A0A0A0"> 591</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        warning('stats:kmeans:FailedToConverge', ...</span><br/>               <span style="color: #A0A0A0"> 592</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                'Failed to converge in %d iterations.', maxit);</span><br/>               <span style="color: #A0A0A0"> 593</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 594</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 595</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % Calculate cluster-wise sums of distances</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 596</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    nonempties = find(m(:)'&gt;0); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 597</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    D(:,nonempties) = <a href="file77.html">distfun</a>(X, C(nonempties,:), distance, iter); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 598</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    d = D((idx-1)*n + (1:n)'); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 599</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    sumD = zeros(k,1); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 600</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    for i = 1:k </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 601</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        sumD(i) = sum(d(idx == i)); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 602</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    end </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 603</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if display &gt; 1 % 'final' or 'iter' </span><br/>               <span style="color: #A0A0A0"> 604</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        disp(sprintf('%d iterations, total sum of distances = %g',iter,totsumD));</span><br/>               <span style="color: #A0A0A0"> 605</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 606</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 607</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % Save the best solution so far</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 608</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    if totsumD &lt; totsumDBest </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 609</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        totsumDBest = totsumD; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 610</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        idxBest = idx; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 611</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        Cbest = C; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 612</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        sumDBest = sumD; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 613</span> <span style="color: #000000; background: #FFFFFF; padding: 1">        if nargout &gt; 3 </span><br/>               <span style="color: #A0A0A0"> 614</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">            Dbest = D;</span><br/>               <span style="color: #A0A0A0"> 615</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 616</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    end </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 617</span> <span style="color: #000000; background: #FFFFFF; padding: 1">end </span><br/>               <span style="color: #A0A0A0"> 618</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 619</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Return the best solution</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 620</span> <span style="color: #000000; background: #FFFFFF; padding: 1">idx = idxBest; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 621</span> <span style="color: #000000; background: #FFFFFF; padding: 1">C = Cbest; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 622</span> <span style="color: #000000; background: #FFFFFF; padding: 1">sumD = sumDBest; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 623</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if nargout &gt; 3 </span><br/>               <span style="color: #A0A0A0"> 624</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    D = Dbest;</span><br/>               <span style="color: #A0A0A0"> 625</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 626</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 627</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 628</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 629</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>