<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><link rel="stylesheet" href="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for imfilter</title><link rel="stylesheet" href="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size: 14pt; padding: 0; background: #FFE4B0">imfilter (5 calls, 0.281 sec)</span><br/><i>Generated 31-Jul-2008 14:38:40 using real time.</i><br/>M-function in file C:\MATLABR14SP3\toolbox\images\images\imfilter.m<br/>[Copy to new window for comparing multiple runs]<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file82.html">edge</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">4</td></tr><tr><td class="td-linebottomrt"><a href="file2.html">SegmentExcGC</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line319">319</a></td><td class="td-linebottomrt"><pre>b1 = imfilter_mex(a,im_size,re...</pre></td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.187 s</td><td class="td-linebottomrt" class="td-linebottomrt">66.5%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=67 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line141">141</a></td><td class="td-linebottomrt"><pre>if isempty(a)</pre></td><td class="td-linebottomrt">5</td><td class="td-linebottomrt">0.031 s</td><td class="td-linebottomrt" class="td-linebottomrt">11.0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=11 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line119">119</a></td><td class="td-linebottomrt"><pre>rank_a = ndims(a);</pre></td><td class="td-linebottomrt">5</td><td class="td-linebottomrt">0.016 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.7%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line250">250</a></td><td class="td-linebottomrt"><pre>b_row_applied = imfilter_mex(a...</pre></td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.016 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.7%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line117">117</a></td><td class="td-linebottomrt"><pre>[a,h,boundary,flags] = parse_i...</pre></td><td class="td-linebottomrt">5</td><td class="td-linebottomrt">0.016 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.7%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt">Other lines &amp; overhead</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.015 s</td><td class="td-linebottomrt">5.3%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.281 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file27.html">images\private\imfilter_mex</a></td><td class="td-linebottomrt">MEX-function</td><td class="td-linebottomrt">7</td><td class="td-linebottomrt">0.187 s</td><td class="td-linebottomrt">66.5%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=67 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file22.html">imfilter>parse_inputs</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">5</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file23.html">padarray</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">7</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file26.html">imfilter>checkMexFileInputs</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">7</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.094 s</td><td class="td-linebottomrt">33.4%</td><td class="td-linebottomrt"><img src="file:///C:\MATLABR14SP3\toolbox\matlab\codetools\private\one-pixel.gif" width=33 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.281 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/>No M-Lint messages.<div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in file</td><td class="td-linebottomrt">341</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">203</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">138</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">64</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">74</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">46.38 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">function b = imfilter(varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%IMFILTER Multidimensional image filtering.</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   B = IMFILTER(A,H) filters the multidimensional array A with the</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   multidimensional filter H.  A can be logical or it can be a </span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   nonsparse numeric array of any class and dimension.  The result, </span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   B, has the same size and class as A.</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Each element of the output, B, is computed using double-precision</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   floating point.  If A is an integer or logical array, then output </span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   elements that exceed the range of the given type are truncated, </span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   and fractional values are rounded.</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   B = IMFILTER(A,H,OPTION1,OPTION2,...) performs multidimensional</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   filtering according to the specified options.  Option arguments can</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   have the following values:</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   - Boundary options</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       X            Input array values outside the bounds of the array</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    are implicitly assumed to have the value X.  When no</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    boundary option is specified, IMFILTER uses X = 0.</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'symmetric'  Input array values outside the bounds of the array</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    are computed by mirror-reflecting the array across</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    the array border.</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'replicate'  Input array values outside the bounds of the array</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    are assumed to equal the nearest array border</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    value.</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'circular'   Input array values outside the bounds of the array</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    are computed by implicitly assuming the input array</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    is periodic.</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   - Output size options</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%     (Output size options for IMFILTER are analogous to the SHAPE option</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%     in the functions CONV2 and FILTER2.)</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'same'       The output array is the same size as the input</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    array.  This is the default behavior when no output</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    size options are specified.</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'full'       The output array is the full filtered result, and so</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    is larger than the input array.</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   - Correlation and convolution</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'corr'       IMFILTER performs multidimensional filtering using</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    correlation, which is the same way that FILTER2</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    performs filtering.  When no correlation or</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    convolution option is specified, IMFILTER uses</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    correlation.</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       'conv'       IMFILTER performs multidimensional filtering using</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%                    convolution.</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Notes</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   -----</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   On Intel Architecture processors, IMFILTER can take advantage of </span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   the Intel Performance Primitives Library (IPPL), thus accelerating</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   its execution time. IPPL is activated only if A and H are both</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   two dimensional and A is uint8, int16 or single.</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Example </span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   -------------</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       originalRGB = imread('peppers.png'); </span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       h = fspecial('motion',50,45); </span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       filteredRGB = imfilter(originalRGB,h); </span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       figure, imshow(originalRGB), figure, imshow(filteredRGB)</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       boundaryReplicateRGB = imfilter(originalRGB,h,'replicate'); </span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       figure, imshow(boundaryReplicateRGB)</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   See also FSPECIAL, CONV2, CONVN, FILTER2, IPPL. </span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   Copyright 1993-2004 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%   $Revision: 1.9.4.4 $  $Date: 2004/08/10 01:40:15 $</span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Testing notes</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Syntaxes</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% --------</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% B = imfilter(A,H)</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% B = imfilter(A,H,Option1, Option2,...)</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% A:       numeric, full, N-D array.  May not be uint64 or int64 class. </span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%          May be empty. May contain Infs and Nans. May be complex. Required.</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%         </span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% H:       double, full, N-D array.  May be empty. May contain Infs and Nans.</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%          May be complex. Required.</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% A and H are not required to have the same number of dimensions. </span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% OptionN  string or a scalar number. Not case sensitive. Optional.  An</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%          error if not recognized.  While there may be up to three options</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%          specified, this is left unchecked and the last option specified</span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%          is used.  Conflicting or inconsistent options are not checked.</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        A choice between these options for boundary options</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Symmetric' </span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Replicate'</span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Circular'</span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%         Scalar #  - Default to zero.</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       A choice between these strings for output options</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Full'</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Same'  - default</span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%       A choice between these strings for functionality options</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Conv' </span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%        'Corr'  - default       </span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% B:   N-D array the same class as A.  If the 'Same' output option was</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      specified, B is the same size as A.  If the 'Full' output option was</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      specified the size of B is size(A)+size(H)-1, remembering that if</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%      size(A)~=size(B) then the missing dimensions have a size of 1.</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% </span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% IMFILTER should use a significantly less amount of memory than CONVN. </span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 117</span> <a name="Line117"></a><span style="color: #000000; background: #FFFFFF; padding: 1">[a,h,boundary,flags] = <a href="file22.html">parse_inputs</a>(varargin{:}); </span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 119</span> <a name="Line119"></a><span style="color: #000000; background: #FFFFFF; padding: 1">rank_a = ndims(a); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF; padding: 1">rank_h = ndims(h); </span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Pad dimensions with ones if filter and image rank are different</span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 123</span> <span style="color: #000000; background: #FFFFFF; padding: 1">size_h = [size(h) ones(1,rank_a-rank_h)]; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 124</span> <span style="color: #000000; background: #FFFFFF; padding: 1">size_a = [size(a) ones(1,rank_h-rank_a)]; </span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if bitand(flags,8) </span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %Full output</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  im_size = size_a+size_h-1;</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  pad = [size(h)-1 ones(1,rank_a-rank_h)];</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF; padding: 1">else </span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %Same output</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 132</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  im_size = size(a); </span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %Calculate the number of pad pixels</span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 134</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  filter_center = floor((size(h)+1)/2); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 135</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  pad = [size(h)-filter_center ones(1,rank_a-rank_h)]; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF; padding: 1">end </span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%Empty Inputs</span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% 'Same' output then size(b) = size(a)</span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% 'Full' output then size(b) = size(h)+size(a)-1 </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 141</span> <a name="Line141"></a><span style="color: #000000; background: #FFF0F0; padding: 1">if isempty(a) </span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  if bitand(flags,4) %Same</span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b = a;</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  else %Full</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if all(im_size&gt;0)</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = a;</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = b(:);</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b(prod(im_size)) = 0;</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = reshape(b,im_size);</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    elseif all(im_size&gt;=0)</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = feval(class(a),zeros(im_size));</span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    else</span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      eid = sprintf('Images:%s:negativeDimensionBadSizeB',mfilename);</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      msg = ['Error in size of B.  At least one dimension is negative. ',...</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">             '\n''Full'' output size calculation is: size(B) = size(A) ',...</span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">             '+ size(H) - 1.'];</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      error(eid,msg);</span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  return;</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 163</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if  isempty(h) </span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  if bitand(flags,4) %Same</span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b = a;</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b(:) = 0;</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  else %Full</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if all(im_size&gt;0)</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = a;</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      if im_size&lt;size_a  %Output is smaller than input</span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        b(:) = [];</span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      else %Grow the array, is this a no-op?</span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        b(:) = 0;</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">        b = b(:);</span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      end</span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b(prod(im_size)) = 0;</span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = reshape(b,im_size);</span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    elseif all(im_size&gt;=0)</span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b = feval(class(a),zeros(im_size));</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    else</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      eid = sprintf('Images:%s:negativeDimensionBadSizeB',mfilename);</span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      msg = ['Error in size of B.  At least one dimension is negative. ',...</span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">             '\n''Full'' output size calculation is: size(B) = size(A) +',...</span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">             ' size(H) - 1.'];</span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      error(eid,msg);</span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  return;</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">end</span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 191</span> <span style="color: #000000; background: #FFFFFF; padding: 1">im_size = int32(im_size); </span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%Starting point in padded image, zero based.</span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 194</span> <span style="color: #000000; background: #FFFFFF; padding: 1">start = int32(pad); </span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%Pad image</span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 197</span> <span style="color: #000000; background: #FFFFFF; padding: 1">a = <a href="file23.html">padarray</a>(a,pad,boundary,'both'); </span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% check for filter separability only if the kernel has at least</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% 289 elements [17x17] (non-double input) or 49 [7x7] (double input),</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% both the image and the filter kernel are two-dimensional and the</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% kernel is not a row or column vector, nor does it contain any NaNs of Infs</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 203</span> <span style="color: #000000; background: #FFFFFF; padding: 1">separable = false; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 204</span> <span style="color: #000000; background: #FFFFFF; padding: 1">numel_h = numel(h); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if isa(a,'double') </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  sep_threshold = (numel_h &gt;= 49); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 207</span> <span style="color: #000000; background: #FFFFFF; padding: 1">else </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 208</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  sep_threshold = (numel_h &gt;= 289); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 209</span> <span style="color: #000000; background: #FFFFFF; padding: 1">end </span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 211</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if sep_threshold &amp;&amp; (rank_a == 2) &amp;&amp; (rank_h == 2) &amp;&amp; ... </span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #000000; background: #FFFFFF; padding: 1">      all(size(h) ~= 1) &amp;&amp; ~any(isnan(h(:))) &amp;&amp; ~any(isinf(h(:)))</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 213</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  [u,s,v] = svd(h); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 214</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  s = diag(s); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 215</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  tol = length(h) * max(s) * eps; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 216</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  rank = sum(s &gt; tol); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 217</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if (rank == 1) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 218</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    separable = true; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 219</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  end </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF; padding: 1">end </span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% Seperate real and imaginary parts of the filter (h) in the M-code and</span><br/>               <span style="color: #A0A0A0"> 223</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">% filter imaginary and real parts of the image (a) in the mex code. </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF; padding: 1">if separable </span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % extract the components of the separable filter</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 226</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  hcol = u(:,1) * sqrt(s(1)); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  hrow = conj(v(:,1))' * sqrt(s(1)); </span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % Create connectivity matrix.  Only use nonzero values of the filter.</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  conn_logical_row = hrow~=0; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 231</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  conn_row = double(conn_logical_row); %input to the mex file must be double </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 232</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  nonzero_h_row = hrow(conn_logical_row); </span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 234</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  conn_logical_col = hcol~=0; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 235</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  conn_col = double(conn_logical_col); %input to the mex file must be double </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  nonzero_h_col = hcol(conn_logical_col); </span><br/>               <span style="color: #A0A0A0"> 237</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % intermediate results should be stored in doubles in order to</span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % maintain sufficient precision</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 240</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  class_of_a = class(a); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 241</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  change_class = false; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 242</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if ~strcmp(class_of_a,'double') </span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    change_class = true;</span><br/>               <span style="color: #A0A0A0"> 244</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    a = double(a);</span><br/>               <span style="color: #A0A0A0"> 245</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 246</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % apply the first component of the separable filter (hrow)</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 248</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  <a href="file26.html">checkMexFileInputs</a>(a,im_size,real(hrow),real(nonzero_h_row),conn_row,... </span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                     start,flags);  </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 250</span> <a name="Line250"></a><span style="color: #000000; background: #FFFFFF; padding: 1">  b_row_applied = <a href="file27.html">imfilter_mex</a>(a,im_size,real(hrow),real(nonzero_h_row),... </span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                               conn_row,start,flags);</span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 253</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if ~isreal(hrow) </span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b_row_applied_cmplx = imfilter_mex(a,im_size,imag(hrow),...</span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                                       imag(nonzero_h_row),conn_row,...</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                                       start,flags);    </span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if isreal(a)</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">      % b_row_applied and b_row_applied_cmplx will always be real;</span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">      % result will always be complex</span><br/>               <span style="color: #A0A0A0"> 260</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b_row_applied = complex(b_row_applied,b_row_applied_cmplx);</span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    else</span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">      % b_row_applied and/or b_row_applied_cmplx may be complex;</span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">      % result will always be complex</span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b_row_applied = complex(imsubtract(real(b_row_applied),...</span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                                         imag(b_row_applied_cmplx)),...</span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                              imadd(imag(b_row_applied),...</span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                                    real(b_row_applied_cmplx)));</span><br/>               <span style="color: #A0A0A0"> 268</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 269</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % apply the other component of the separable filter (hcol)</span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % prepare b_next which is an intermediate result after applying both</span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % real and complex parts of hrow to the input image</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  b_row_applied = <a href="file23.html">padarray</a>(b_row_applied,pad,boundary,'both'); </span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 277</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  <a href="file26.html">checkMexFileInputs</a>(b_row_applied,im_size,real(hcol),real(nonzero_h_col),... </span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                     conn_col,start,flags);</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 279</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  b1 = <a href="file27.html">imfilter_mex</a>(b_row_applied,im_size,real(hcol),real(nonzero_h_col),... </span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #000000; background: #FFFFFF; padding: 1">                    conn_col,start,flags);</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 282</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if ~isreal(hcol) </span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b2 = imfilter_mex(b_row_applied,im_size,imag(hcol),imag(nonzero_h_col),...</span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">                      conn_col,start,flags);</span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    if change_class</span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">      b2 = feval(class_of_a,b2);</span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    end</span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % change the class back if necessary  </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 291</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if change_class </span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b1 = feval(class_of_a,b1);</span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %If input is not complex, the output should not be complex. COMPLEX always</span><br/>               <span style="color: #A0A0A0"> 296</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %creates an imaginary part even if the imaginary part is zeros.</span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 297</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if isreal(hcol) </span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % b will always be real</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 299</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    b = b1; </span><br/>               <span style="color: #A0A0A0"> 300</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  elseif isreal(b_row_applied)</span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % b1 and b2 will always be real. b will always be complex</span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b = complex(b1,b2);</span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  else</span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % b1 and/or b2 may be complex.  b will always be complex</span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b = complex(imsubtract(real(b1),imag(b2)),imadd(imag(b1),real(b2)));</span><br/>               <span style="color: #A0A0A0"> 306</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 308</span> <span style="color: #000000; background: #FFFFFF; padding: 1">else % non-separable filter case </span><br/>               <span style="color: #A0A0A0"> 309</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % Create connectivity matrix.  Only use nonzero values of the filter.</span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  conn_logical = h~=0; </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 312</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  conn = double( conn_logical );  %input to the mex file must be double </span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 314</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  nonzero_h = h(conn_logical); </span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % Seperate real and imaginary parts of the filter (h) in the M-code and</span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  % filter imaginary and real parts of the image (a) in the mex code. </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 318</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  <a href="file26.html">checkMexFileInputs</a>(a,im_size,real(h),real(nonzero_h),conn,start,flags); </span><br/><span style="color: #FF0000">  0.19 </span><span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 319</span> <a name="Line319"></a><span style="color: #000000; background: #FF8080; padding: 1">  b1 = <a href="file27.html">imfilter_mex</a>(a,im_size,real(h),real(nonzero_h),conn,start,flags); </span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 321</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if ~isreal(h) </span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    checkMexFileInputs(a,im_size,imag(h),imag(nonzero_h),conn,start,flags);</span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b2 = imfilter_mex(a,im_size,imag(h),imag(nonzero_h),conn,start,flags);</span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  </span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %If input is not complex, the output should not be complex. COMPLEX always</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">  %creates an imaginary part even if the imaginary part is zeros.</span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 328</span> <span style="color: #000000; background: #FFFFFF; padding: 1">  if isreal(h) </span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % b will always be real</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 330</span> <span style="color: #000000; background: #FFFFFF; padding: 1">    b = b1; </span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  elseif isreal(a)</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % b1 and b2 will always be real. b will always be complex</span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b = complex(b1,b2);</span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  else</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">    % b1 and/or b2 may be complex.  b will always be complex</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">    b = complex(imsubtract(real(b1),imag(b2)),imadd(imag(b1),real(b2)));</span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #A0A0A0; background: #FFFFFF; padding: 1">  end</span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 338</span> <span style="color: #000000; background: #FFFFFF; padding: 1">end </span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/>               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF; padding: 1">%======================================================================</span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #228B22; background: #FFFFFF; padding: 1"></span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>